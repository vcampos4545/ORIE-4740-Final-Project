tree.mse_cv <- mean((tree.pred - wineTest$Price)^2)
plot(cv.wine$size,cv.wine$dev)
# Regression Tree predicting Rating
tree.wine <- tree(Rating~.,wine,subset = train)
summary(tree.wine)
plot(tree.wine)
text(tree.wine,pretty=0)
tree.pred <- predict(tree.wine, wineTest)
tree.mse_nocv <- mean((tree.pred - wineTest$Rating)^2)
cv.wine <- cv.tree(tree.wine)
bestSize <- cv.wine$size[which.min(cv.wine$dev)]
prune.wine <- prune.tree(tree.wine, best=bestSize)
tree.pred <- predict(prune.wine, wineTest)
tree.mse_cv <- mean((tree.pred - wineTest$Rating)^2)
plot(cv.wine$size,cv.wine$dev)
# Bagging predicting Price
bag.wine <- randomForest(Price~., wine, subset=train, mtry=10, importance=TRUE)
bag.pred <- predict(bag.wine, newdata=wineTest)
mean((bag.pred - wineTest$Price)^2)
# Bagging predicting Rating
bag.wine <- randomForest(Rating~., wine, subset=train, mtry=10, importance=TRUE)
bag.pred <- predict(bag.wine, newdata=wineTest)
mean((bag.pred - wineTest$Rating)^2)
rf.errs <- rep(0, 10)
for (m in c(1:10)) {
rf.wine <- randomForest(Price~., wine, subset=train,mtry=m, importance=TRUE)
rf.pred <- predict(rf.wine, newdata=wineTest)
rf.errs[m] <- mean((rf.pred - wineTest$Price)^2)
}
plot(rf.errs, type="b")
wine <- read.csv("WineData.csv")
wine <- subset(wine, select = -c(X, Id, Name,StyleName,Region,Winery))
wine <- subset(wine, Body != -1 & Acidity != -1 & Year > 1950 & Price <1000)
wine <- as_tibble(wine)
wine$Type <- as.factor(wine$Type)
wine$Vintage <- as.factor(wine$Vintage)
wine$Nat <- as.factor(wine$Nat)
wine$Acidity <- as.factor(wine$Acidity)
wine$Country <- as.factor(wine$Country)
wine$Size <- as.factor(wine$Size)
wine$Price <- log(wine$Price)
# GAM predicting Rating
gam1 <- gam(Price~s(Rating,4)+s(NumRatings,4)+Type+s(Year,4)+s(Body,4)+Acidity+Vintage+Nat+Size+Country,data = wine)
par(mfrow=c(2,5))
plot(gam1, se=TRUE, col="red")
# GAM predicting Price
gam2 <- gam(Rating~s(Price,4)+s(NumRatings,4)+Type+s(Year,4)+s(Body,4)+Acidity+Vintage+Nat+Size+Country,data = wine)
par(mfrow=c(2,5))
plot(gam2, se=TRUE, col="red")
View(wine)
wine <- read.csv("WineData.csv")
wine$Acidity <- as.factor(wine$Acidity)
wine <- read.csv("WineData.csv")
max(wine$Acidity)
max(wine$Bpdy)
max(wine$Body)
data(wineTrain, package='xgboost')
data(wineTest, package='xgboost')
train <- wineTrain
test <- wineTest
# fit model
bst <- xgboost(data = train$data, label = train$label, max.depth = 2, eta = 1, nrounds = 2,
nthread = 2, objective = "binary:logistic")
# predict
pred <- predict(bst, test$data)
data(wineTrain, package='xgboost')
wine <- read.csv("WineData.csv")
wine <- subset(wine, select = -c(X, Id, Name,StyleName,Region,Winery))
wine <- subset(wine, Body != -1 & Acidity != -1 & Year > 1950 &  Price <1000)
wine <- as_tibble(wine)
wine$Type <- as.factor(wine$Type)
wine$Vintage <- as.factor(wine$Vintage)
wine$Nat <- as.factor(wine$Nat)
wine$Acidity <- as.factor(wine$Acidity)
wine$Country <- as.factor(wine$Country)
wine$Size <- as.factor(wine$Size)
wine$Price <- wine$Price
wine$Rating <- wine$Rating
wine$Price <- log(wine$Price)
set.seed(1)
train <- sample(1:nrow(wine), 0.6*nrow(wine))
wineTrain <- wine[train,]
wineTest <- wine[-train,]
par(mfrow=c(1,1))
data(wineTrain, package='xgboost')
train <- wineTrain
test <- wineTest
# fit model
bst <- xgboost(data = train, label = train$label, max.depth = 2, eta = 1, nrounds = 2,
nthread = 2, objective = "binary:logistic")
# predict
pred <- predict(bst, test)
wine <- read.csv("WineData.csv")
wine <- subset(wine, select = -c(X, Id, Name,StyleName,Region,Winery))
wine <- subset(wine, Body != -1 & Acidity != -1 & Country != 'NONE' )
wine <- as_tibble(wine)
wine$Type <- as.factor(wine$Type)
wine$Vintage <- as.factor(wine$Vintage)
wine$Nat <- as.factor(wine$Nat)
wine$Acidity <- as.factor(wine$Acidity)
wine$Country <- as.factor(wine$Country)
wine$Size <- as.factor(wine$Size)
wine$Price <- log(wine$Price)
# GAM predicting Rating
gam1 <- gam(Price~s(Rating,4)+s(NumRatings,4)+Type+s(Year,4)+s(Body,4)+Acidity+Vintage+Nat+Size+Country,data = wine)
par(mfrow=c(2,5))
plot(gam1, se=TRUE, col="red")
# GAM predicting Price
gam2 <- gam(Rating~s(Price,4)+s(NumRatings,4)+Type+s(Year,4)+s(Body,4)+Acidity+Vintage+Nat+Size+Country,data = wine)
par(mfrow=c(2,5))
plot(gam2, se=TRUE, col="red")
wine <- read.csv("WineData.csv")
wine <- subset(wine, select = -c(X, Id, Name,StyleName,Region,Winery))
wine <- subset(wine, Body != -1 & Acidity != -1 & Country != 'NONE' & Year >0)
wine <- as_tibble(wine)
wine$Type <- as.factor(wine$Type)
wine$Vintage <- as.factor(wine$Vintage)
wine$Nat <- as.factor(wine$Nat)
wine$Acidity <- as.factor(wine$Acidity)
wine$Country <- as.factor(wine$Country)
wine$Size <- as.factor(wine$Size)
wine$Price <- log(wine$Price)
# GAM predicting Rating
gam1 <- gam(Price~s(Rating,4)+s(NumRatings,4)+Type+s(Year,4)+s(Body,4)+Acidity+Vintage+Nat+Size+Country,data = wine)
par(mfrow=c(2,5))
plot(gam1, se=TRUE, col="red")
# GAM predicting Price
gam2 <- gam(Rating~s(Price,4)+s(NumRatings,4)+Type+s(Year,4)+s(Body,4)+Acidity+Vintage+Nat+Size+Country,data = wine)
par(mfrow=c(2,5))
plot(gam2, se=TRUE, col="red")
wine <- read.csv("WineData.csv")
wine <- subset(wine, select = -c(X, Id, Name,StyleName,Region,Winery))
wine <- subset(wine, Body != -1 & Acidity != -1 & Country != 'NONE' & Year >0)
wine <- as_tibble(wine)
wine$Type <- as.factor(wine$Type)
wine$Vintage <- as.factor(wine$Vintage)
wine$Nat <- as.factor(wine$Nat)
wine$Acidity <- as.factor(wine$Acidity)
wine$Country <- as.factor(wine$Country)
wine$Size <- as.factor(wine$Size)
wine$Price <- wine$Price
wine$Rating <- wine$Rating
#wine$Price <- log(wine$Price)
set.seed(1)
train <- sample(1:nrow(wine), 0.6*nrow(wine))
wineTrain <- wine[train,]
wineTest <- wine[-train,]
par(mfrow=c(1,1))
rf.wine <- randomForest(log(Price)~., wine, subset=train,mtry=3, importance=TRUE)
rf.pred <- predict(rf.wine, newdata=wineTest)
mean((exp(rf.pred) - wineTest$Rating)^2)
mean((exp(rf.pred) - wineTest$Price)^2)
wine <- read.csv("WineData.csv")
wine <- subset(wine, select = -c(X, Id, Name,StyleName,Region,Winery))
wine <- subset(wine, Body != -1 & Acidity != -1 & Country != 'NONE' & Year >0)
wine <- as_tibble(wine)
wine$Type <- as.factor(wine$Type)
wine$Vintage <- as.factor(wine$Vintage)
wine$Nat <- as.factor(wine$Nat)
wine$Acidity <- as.factor(wine$Acidity)
wine$Country <- as.factor(wine$Country)
wine$Size <- as.factor(wine$Size)
wine$Price <- wine$Price
wine$Rating <- wine$Rating
#wine$Price <- log(wine$Price)
set.seed(1)
train <- sample(1:nrow(wine), 0.6*nrow(wine))
wineTrain <- wine[train,]
wineTest <- wine[-train,]
par(mfrow=c(1,1))
rf.wine <- randomForest(log(Price)~., wine, subset=train,mtry=3, importance=TRUE)
rf.pred <- predict(rf.wine, newdata=wineTest)
mean((exp(rf.pred) - wineTest$Price)^2)
wine <- read.csv("WineData.csv")
wine <- subset(wine, select = -c(X, Id, Name,StyleName,Region,Winery))
wine <- subset(wine, Body != -1 & Acidity != -1 & Country != 'NONE' & Year >0)
wine <- as_tibble(wine)
wine$Type <- as.factor(wine$Type)
wine$Vintage <- as.factor(wine$Vintage)
wine$Nat <- as.factor(wine$Nat)
wine$Acidity <- as.factor(wine$Acidity)
wine$Country <- as.factor(wine$Country)
wine$Size <- as.factor(wine$Size)
wine$Price <- wine$Price
wine$Rating <- wine$Rating
#wine$Price <- log(wine$Price)
set.seed(1)
train <- sample(1:nrow(wine), 0.6*nrow(wine))
wineTrain <- wine[train,]
wineTest <- wine[-train,]
par(mfrow=c(1,1))
rf.wine <- randomForest(log(Price)~., wine, subset=train,mtry=3, importance=TRUE)
rf.pred <- predict(rf.wine, newdata=wineTest)
mean((10^(rf.pred) - wineTest$Price)^2)
mean((rf.pred - wineTest$Price)^2)
wine <- read.csv("WineData.csv")
wine <- subset(wine, select = -c(X, Id, Name,StyleName,Region,Winery))
wine <- subset(wine, Body != -1 & Acidity != -1 & Country != 'NONE' & Year >1950)
wine <- as_tibble(wine)
wine$Type <- as.factor(wine$Type)
wine$Vintage <- as.factor(wine$Vintage)
wine$Nat <- as.factor(wine$Nat)
wine$Acidity <- as.factor(wine$Acidity)
wine$Country <- as.factor(wine$Country)
wine$Size <- as.factor(wine$Size)
wine$Price <- wine$Price
wine$Rating <- wine$Rating
#wine$Price <- log(wine$Price)
set.seed(1)
train <- sample(1:nrow(wine), 0.6*nrow(wine))
wineTrain <- wine[train,]
wineTest <- wine[-train,]
par(mfrow=c(1,1))
rf.wine <- randomForest(log(Price)~., wine, subset=train,mtry=3, importance=TRUE)
rf.pred <- predict(rf.wine, newdata=wineTest)
mean((rf.pred - wineTest$Price)^2)
x <- (rf.pred-wineTest$Price)^2
max(x)
sqrt(110114472)
wine <- read.csv("WineData.csv")
wine <- subset(wine, select = -c(X, Id, Name,StyleName,Region,Winery))
wine <- subset(wine, Body != -1 & Acidity != -1 & Country != 'NONE')
wine <- as_tibble(wine)
wine$Type <- as.factor(wine$Type)
wine$Vintage <- as.factor(wine$Vintage)
wine$Nat <- as.factor(wine$Nat)
wine$Acidity <- as.factor(wine$Acidity)
wine$Country <- as.factor(wine$Country)
wine$Size <- as.factor(wine$Size)
wine$Price <- wine$Price
wine$Rating <- wine$Rating
#wine$Price <- log(wine$Price)
set.seed(1)
train <- sample(1:nrow(wine), 0.6*nrow(wine))
wineTrain <- wine[train,]
wineTest <- wine[-train,]
par(mfrow=c(1,1))
rf.wine <- randomForest(log(Price)~., wine, subset=train,mtry=3, importance=TRUE)
rf.pred <- predict(rf.wine, newdata=wineTest)
x <- (rf.pred-wineTest$Price)^2
mean((rf.pred - wineTest$Price)^2)
max(x)
wine <- read.csv("WineData.csv")
wine <- subset(wine, select = -c(X, Id, Name,StyleName,Region,Winery))
wine <- subset(wine, Body != -1 & Acidity != -1 & Country != 'NONE')
wine <- as_tibble(wine)
wine$Type <- as.factor(wine$Type)
wine$Vintage <- as.factor(wine$Vintage)
wine$Nat <- as.factor(wine$Nat)
wine$Acidity <- as.factor(wine$Acidity)
wine$Country <- as.factor(wine$Country)
wine$Size <- as.factor(wine$Size)
wine$Price <- wine$Price
wine$Rating <- wine$Rating
#wine$Price <- log(wine$Price)
set.seed(1)
train <- sample(1:nrow(wine), 0.6*nrow(wine))
wineTrain <- wine[train,]
wineTest <- wine[-train,]
par(mfrow=c(1,1))
rf.wine <- randomForest(log(Price)~., wine, subset=train,mtry=3, importance=TRUE)
rf.pred <- predict(rf.wine, newdata=wineTest)
x <- (exp(rf.pred)-wineTest$Price)^2
mean((exp(rf.pred) - wineTest$Price)^2)
max(x)
x <- (10^(rf.pred)-wineTest$Price)^2
mean((10^(rf.pred) - wineTest$Price)^2)
wine <- read.csv("WineData.csv")
wine <- subset(wine, select = -c(X, Id, Name,StyleName,Region,Winery))
wine <- subset(wine, Body != -1 & Acidity != -1 & Country != 'NONE' & Year >0)
wine <- as_tibble(wine)
wine$Type <- as.factor(wine$Type)
wine$Vintage <- as.factor(wine$Vintage)
wine$Nat <- as.factor(wine$Nat)
wine$Acidity <- as.factor(wine$Acidity)
wine$Country <- as.factor(wine$Country)
wine$Size <- as.factor(wine$Size)
wine$Price <- log(wine$Price)
# GAM predicting Rating
gam1 <- gam(Price~s(Rating,4)+s(NumRatings,4)+Type+s(Year,4)+s(Body,4)+Acidity+Vintage+Nat+Size+Country,data = wine)
par(mfrow=c(2,5))
plot(gam1, se=TRUE, col="red")
# GAM predicting Price
gam2 <- gam(Rating~s(Price,4)+s(NumRatings,4)+Type+s(Year,4)+s(Body,4)+Acidity+Vintage+Nat+Size+Country,data = wine)
par(mfrow=c(2,5))
plot(gam2, se=TRUE, col="red")
wine <- read.csv("WineData.csv")
wine <- subset(wine, select = -c(X, Id, Name,StyleName,Region,Winery))
wine <- subset(wine, Body != -1 & Acidity != -1 & Country != 'NONE' & Year >0)
wine <- as_tibble(wine)
wine$Type <- as.factor(wine$Type)
wine$Vintage <- as.factor(wine$Vintage)
wine$Nat <- as.factor(wine$Nat)
wine$Acidity <- as.factor(wine$Acidity)
wine$Country <- as.factor(wine$Country)
wine$Size <- as.factor(wine$Size)
wine$Price <- log(wine$Price)
# GAM predicting Rating
gam1 <- gam(Price~s(Rating,4)+s(NumRatings,4)+Type+s(Year,4)+s(Body,4)+Acidity+Vintage+Nat+Size+Country,data = wine)
par(mfrow=c(2,5))
plot(gam1, se=TRUE, col="red")
# GAM predicting Price
gam2 <- gam(Rating~s(Price,4)+s(NumRatings,4)+Type+s(Year,4)+s(Body,4)+Acidity+Vintage+Nat+Size+Country,data = wine)
par(mfrow=c(2,5))
plot(gam2, se=TRUE, col="red")
wine <- read.csv("WineData.csv")
wine <- subset(wine, select = -c(X, Id, Name,StyleName,Region,Winery))
wine <- subset(wine, Body != -1 & Acidity != -1 & Country != 'NONE' & Year >0)
wine <- as_tibble(wine)
wine$Type <- as.factor(wine$Type)
wine$Vintage <- as.factor(wine$Vintage)
wine$Nat <- as.factor(wine$Nat)
wine$Acidity <- as.factor(wine$Acidity)
wine$Country <- as.factor(wine$Country)
wine$Size <- as.factor(wine$Size)
wine$Price <- log(wine$Price)
# GAM predicting Rating
par(mfrow=c(1,1))
gam1 <- gam(Price~s(Rating,4)+s(NumRatings,4)+Type+s(Year,4)+s(Body,4)+Acidity+Vintage+Nat+Size+Country,data = wine)
plot(gam1, se=TRUE, col="red")
wine <- read.csv("WineData.csv")
wine <- subset(wine, select = -c(X, Id, Name,StyleName,Region,Winery))
wine <- subset(wine, Body != -1 & Acidity != -1 & Country != 'NONE' & Year >0)
wine <- as_tibble(wine)
wine$Type <- as.factor(wine$Type)
wine$Vintage <- as.factor(wine$Vintage)
wine$Nat <- as.factor(wine$Nat)
wine$Acidity <- as.factor(wine$Acidity)
wine$Country <- as.factor(wine$Country)
#wine$Size <- as.factor(wine$Size)
wine$Price <- log(wine$Price)
# GAM predicting Rating
par(mfrow=c(1,1))
gam1 <- gam(Price~s(Rating,4)+s(NumRatings,4)+Type+s(Year,4)+s(Body,4)+Acidity+Vintage+Nat+s(Size,4)+Country,data = wine)
plot(gam1, se=TRUE, col="red")
# GAM predicting Price
plot(gam1, col="red")
plot(gam1, se=TRUE, col="red")
mean((gam.pred - wineTest$Price)^2)
wine <- read.csv("WineData.csv")
wine <- subset(wine, select = -c(X, Id, Name,StyleName,Region,Winery))
wine <- subset(wine, Body != -1 & Acidity != -1 & Country != 'NONE' & Year >0)
wine <- as_tibble(wine)
wine$Type <- as.factor(wine$Type)
wine$Vintage <- as.factor(wine$Vintage)
wine$Nat <- as.factor(wine$Nat)
wine$Acidity <- as.factor(wine$Acidity)
wine$Country <- as.factor(wine$Country)
#wine$Size <- as.factor(wine$Size)
wine$Price <- log(wine$Price)
# GAM predicting Price
set.seed(1)
train <- sample(1:nrow(wine), 0.6*nrow(wine))
wineTrain <- wine[train,]
wineTest <- wine[-train,]
par(mfrow=c(1,1))
gam1 <- gam(Price~s(Rating,4)+s(NumRatings,4)+Type+s(Year,4)+s(Body,4)+Acidity+Vintage+Nat+s(Size,4)+Country,data = wineTrain)
plot(gam1, se=TRUE, col="red")
gam.pred <- predict(gam1,wineTest)
mean((gam.pred - wineTest$Price)^2)
wine <- read.csv("WineData.csv")
wine <- subset(wine, select = -c(X, Id, Name,StyleName,Region,Winery))
wine <- subset(wine, Body != -1 & Acidity != -1 & Country != 'NONE' & Year >0)
wine <- as_tibble(wine)
wine$Type <- as.factor(wine$Type)
wine$Vintage <- as.factor(wine$Vintage)
wine$Nat <- as.factor(wine$Nat)
wine$Acidity <- as.factor(wine$Acidity)
wine$Country <- as.factor(wine$Country)
#wine$Size <- as.factor(wine$Size)
wine$Price <- log(wine$Price)
# GAM predicting Price
set.seed(2)
train <- sample(1:nrow(wine), 0.6*nrow(wine))
wineTrain <- wine[train,]
wineTest <- wine[-train,]
par(mfrow=c(1,1))
gam1 <- gam(Price~s(Rating,4)+s(NumRatings,4)+Type+s(Year,4)+s(Body,4)+Acidity+Vintage+Nat+s(Size,4)+Country,data = wineTrain)
plot(gam1, se=TRUE, col="red")
gam.pred <- predict(gam1,wineTest)
mean((gam.pred - wineTest$Price)^2)
pred.diff <- gam.pred - wineTest$Price
??log
wine <- read.csv("WineData.csv")
wine <- subset(wine, select = -c(X, Id, Name,StyleName,Region,Winery))
wine <- subset(wine, Body != -1 & Acidity != -1 & Country != 'NONE' & Year >0)
wine <- as_tibble(wine)
wine$Type <- as.factor(wine$Type)
wine$Vintage <- as.factor(wine$Vintage)
wine$Nat <- as.factor(wine$Nat)
wine$Acidity <- as.factor(wine$Acidity)
wine$Country <- as.factor(wine$Country)
#wine$Size <- as.factor(wine$Size)
wine$Price <- log(wine$Price)
# GAM predicting Price
set.seed(2)
train <- sample(1:nrow(wine), 0.6*nrow(wine))
wineTrain <- wine[train,]
wineTest <- wine[-train,]
par(mfrow=c(1,1))
gam1 <- gam(Price~s(Rating,4)+s(NumRatings,4)+Type+s(Year,4)+s(Body,4)+Acidity+Vintage+Nat+s(Size,4)+Country,data = wineTrain)
plot(gam1, se=TRUE, col="red")
gam.pred <- predict(gam1,wineTest)
pred.diff <- exp(gam.pred) - exp(wineTest$Price)
max(pred.diff)
mean(pred.diff)
pred.diff <- abs(exp(gam.pred) - exp(wineTest$Price))
mean(pred.diff)
pred.diff
wine <- scale(wine)
wine <- read.csv("WineData.csv")
wine <- subset(wine, select = -c(X, Id, Name,StyleName,Region,Winery))
wine <- subset(wine, Body != -1 & Acidity != -1 & Country != 'NONE' & Year >0)
wine <- as_tibble(wine)
wine$Type <- as.factor(wine$Type)
wine$Vintage <- as.factor(wine$Vintage)
wine$Nat <- as.factor(wine$Nat)
wine$Acidity <- as.factor(wine$Acidity)
wine$Country <- as.factor(wine$Country)
#wine$Size <- as.factor(wine$Size)
wine$Price <- log(wine$Price)
wine$Size <- scale(wine, select = c(Rating,NumRatings,Year,Body,Size))
# GAM predicting Price
set.seed(2)
train <- sample(1:nrow(wine), 0.6*nrow(wine))
wineTrain <- wine[train,]
wineTest <- wine[-train,]
par(mfrow=c(5,2))
gam1 <- gam(Price~s(Rating,4)+s(NumRatings,4)+Type+s(Year,4)+s(Body,4)+Acidity+Vintage+Nat+s(Size,4)+Country,data = wineTrain)
plot(gam1, se=TRUE, col="red")
gam.pred <- predict(gam1,wineTest)
pred.diff <- abs(exp(gam.pred) - exp(wineTest$Price))
wine <- read.csv("WineData.csv")
wine <- subset(wine, select = -c(X, Id, Name,StyleName,Region,Winery))
wine <- subset(wine, Body != -1 & Acidity != -1 & Country != 'NONE' & Year >0)
wine <- as_tibble(wine)
wine$Type <- as.factor(wine$Type)
wine$Vintage <- as.factor(wine$Vintage)
wine$Nat <- as.factor(wine$Nat)
wine$Acidity <- as.factor(wine$Acidity)
wine$Country <- as.factor(wine$Country)
#wine$Size <- as.factor(wine$Size)
wine$Price <- log(wine$Price)
wine$Size <- scale(wine, select = c(Rating,NumRatings,Year,Body,Size))
# GAM predicting Price
set.seed(2)
train <- sample(1:nrow(wine), 0.6*nrow(wine))
wineTrain <- wine[train,]
wineTest <- wine[-train,]
par(mfrow=c(2,5))
gam1 <- gam(Price~s(Rating,4)+s(NumRatings,4)+Type+s(Year,4)+s(Body,4)+Acidity+Vintage+Nat+s(Size,4)+Country,data = wineTrain)
plot(gam1, se=TRUE, col="red")
wine <- read.csv("WineData.csv")
wine <- subset(wine, select = -c(X, Id, Name,StyleName,Region,Winery))
wine <- subset(wine, Body != -1 & Acidity != -1 & Country != 'NONE' & Year >0)
wine <- as_tibble(wine)
wine$Type <- as.factor(wine$Type)
wine$Vintage <- as.factor(wine$Vintage)
wine$Nat <- as.factor(wine$Nat)
wine$Acidity <- as.factor(wine$Acidity)
wine$Country <- as.factor(wine$Country)
#wine$Size <- as.factor(wine$Size)
wine$Price <- log(wine$Price)
subset(wine, select = c(Rating,NumRatings,Year,Body,Size)) <- scale(wine, select = c(Rating,NumRatings,Year,Body,Size))
# GAM predicting Price
set.seed(2)
train <- sample(1:nrow(wine), 0.6*nrow(wine))
wineTrain <- wine[train,]
wineTest <- wine[-train,]
par(mfrow=c(2,5))
gam1 <- gam(Price~s(Rating,4)+s(NumRatings,4)+Type+s(Year,4)+s(Body,4)+Acidity+Vintage+Nat+s(Size,4)+Country,data = wineTrain)
plot(gam1, se=TRUE, col="red")
wine <- read.csv("WineData.csv")
wine <- subset(wine, select = -c(X, Id, Name,StyleName,Region,Winery))
wine <- subset(wine, Body != -1 & Acidity != -1 & Country != 'NONE' & Year >0)
wine <- as_tibble(wine)
wine$Type <- as.factor(wine$Type)
wine$Vintage <- as.factor(wine$Vintage)
wine$Nat <- as.factor(wine$Nat)
wine$Acidity <- as.factor(wine$Acidity)
wine$Country <- as.factor(wine$Country)
#wine$Size <- as.factor(wine$Size)
wine$Price <- log(wine$Price)
wine$Rating <- scale(wine$Rating)
# GAM predicting Price
set.seed(2)
train <- sample(1:nrow(wine), 0.6*nrow(wine))
wineTrain <- wine[train,]
wineTest <- wine[-train,]
par(mfrow=c(2,5))
gam1 <- gam(Price~s(Rating,4)+s(NumRatings,4)+Type+s(Year,4)+s(Body,4)+Acidity+Vintage+Nat+s(Size,4)+Country,data = wineTrain)
plot(gam1, se=TRUE, col="red")
wine <- read.csv("WineData.csv")
wine <- subset(wine, select = -c(X, Id, Name,StyleName,Region,Winery))
wine <- subset(wine, Body != -1 & Acidity != -1 & Country != 'NONE' & Year >0)
wine <- as_tibble(wine)
wine$Type <- as.factor(wine$Type)
wine$Vintage <- as.factor(wine$Vintage)
wine$Nat <- as.factor(wine$Nat)
wine$Acidity <- as.factor(wine$Acidity)
wine$Country <- as.factor(wine$Country)
#wine$Size <- as.factor(wine$Size)
wine$Price <- log(wine$Price)
wine$Rating <- scale(wine$Rating)[1,]
# GAM predicting Price
set.seed(2)
train <- sample(1:nrow(wine), 0.6*nrow(wine))
wineTrain <- wine[train,]
wineTest <- wine[-train,]
par(mfrow=c(2,5))
gam1 <- gam(Price~s(Rating,4)+s(NumRatings,4)+Type+s(Year,4)+s(Body,4)+Acidity+Vintage+Nat+s(Size,4)+Country,data = wineTrain)
plot(gam1, se=TRUE, col="red")
