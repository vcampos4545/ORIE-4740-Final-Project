df.Pricelm <- lm(Price ~ ., data=df)
df.Ratinglm <- lm(Rating ~ ., data = df)
dfPriceRes <- rstudent(df.Pricelm)
dfRatingRes <- rstudent(df.Ratinglm)
dfPrice.post <- df[abs(dfPriceRes) < 3,]
dfRating.post <- df[abs(dfRatingRes) < 3,]
dfPrice.post <- na.omit(dfPrice.post)
dfRating.post <- na.omit(dfRating.post)
rankifremoved <- sapply(1:ncol(dfPrice.post), function (x) qr(dfPrice.post[,-x])$rank)
which(rankifremoved == max(rankifremoved))
dfPrice.psot
dfPrice.post
library(e1071)
library(fastDummies)
names(iris)
iris[,-5]
iris
Price_pr.out <- prcomp(dfPrice.post[,-c('Price')] , scale=TRUE)
Price_pr.out <- prcomp(subset(dfPrice.post, select = -c('Price')) , scale=TRUE)
Rating_pr.out <- prcomp(subset(dfRating.post, select = -c('Rating')) , scale=TRUE)
Price_pr.out <- prcomp(subset(dfPrice.post, select = -c(Price)) , scale=TRUE)
Rating_pr.out <- prcomp(subset(dfRating.post, select = -c(Rating)) , scale=TRUE)
which(apply(dfPrice.post, 2, var)==0)
dfPrice.post[ , which(apply(dfPrice.post, 2, var) != 0)]
which(apply(dfPrice.post, 2, var)==0)
dfPrice.post[ , which(apply(dfPrice.post, 2, var) != 0)]
which(apply(dfRating.post, 2, var)==0)
which(apply(dfPrice.post, 2, var)==0)
dfPrice.post[ , which(apply(dfPrice.post, 2, var) != 0)]
which(apply(dfRating.post, 2, var)==0)
dfRating.post[ , which(apply(dfRating.post, 2, var) != 0)]
Price_pr.out <- prcomp(subset(dfPrice.post, select = -c(Price, Country.CountryMexico)) , scale=TRUE)
Price_pr.out <- prcomp(subset(dfPrice.post, select = -c(Price, CountryMexico)) , scale=TRUE)
Price_pr.out <- prcomp(subset(dfPrice.post, select = -c(Price, Country.Mexico)) , scale=TRUE)
which(apply(dfRating.post, 2, var)==0)
which(apply(dfPrice.post, 2, var) != 0)
df <- read.csv("WineData.csv")
df <- na.omit(df)
df <- subset(df, select = -c(X, Id, Name, Winery, StyleName, Region))
df <- subset(df, Acidity != -1 & Year > 1950)
df$Type <- as.factor(df$Type)
df$Type <- model.matrix( ~ Type - 1, data=df)
df$Vintage <- as.factor(df$Vintage)
df$Vintage <- model.matrix( ~ Vintage - 1, data=df)
df$Nat <- as.factor(df$Nat)
df$Nat <- model.matrix( ~ Nat - 1, data=df)
df$Country <- as.factor(df$Country)
df$Country <- model.matrix( ~ Country - 1, data=df)
df$Size <- as.factor(df$Size)
df$Size <- model.matrix( ~ Size - 1, data=df)
df.Pricelm <- lm(Price ~ ., data=df)
df.Ratinglm <- lm(Rating ~ ., data = df)
dfPriceRes <- rstudent(df.Pricelm)
dfRatingRes <- rstudent(df.Ratinglm)
dfPrice.post <- df[abs(dfPriceRes) < 3,]
dfRating.post <- df[abs(dfRatingRes) < 3,]
dfPrice.post <- na.omit(dfPrice.post)
dfRating.post <- na.omit(dfRating.post)
which(apply(dfPrice.post, 2, var) != 0)
dfPrice.post[ , which(apply(dfPrice.post, 2, var) != 0)]
which(apply(dfPrice.post, 2, var) != 0)
which(apply(dfPrice.post, 2, var) == 0)
dfPrice.post[ , which(apply(dfPrice.post, 2, var) == 0)]
Price_pr.out <- prcomp(subset(dfPrice.post, select = -c(1, 28)) , scale=TRUE)
which(apply(dfPrice.post, 2, var) != 0)
which(apply(dfPrice.post, 2, var) == 0)
Price_pr.out <- prcomp(dfPrice.post[-c(28)], scale=TRUE)
which(apply(dfPrice.post[-c(28)], 2, var) == 0)
which(apply(dfPrice.post[,-c(28)], 2, var) == 0)
dfPrice.post[-c(28)]
dfPrice.post[-c(29)]
dfPrice.post[-c(27)]
which(apply(dfPrice.post[], 2, var) == 0)
library(dplyr)
df <- read.csv("WineData.csv")
df <- na.omit(df)
df <- subset(df, select = -c(X, Id, Name, Winery, StyleName, Region))
df <- subset(df, Acidity != -1 & Year > 1950)
df$Type <- as.factor(df$Type)
df$Type <- model.matrix( ~ Type - 1, data=df)
df$Vintage <- as.factor(df$Vintage)
df$Vintage <- model.matrix( ~ Vintage - 1, data=df)
df$Nat <- as.factor(df$Nat)
df$Nat <- model.matrix( ~ Nat - 1, data=df)
df$Country <- as.factor(df$Country)
df$Country <- model.matrix( ~ Country - 1, data=df)
df$Size <- as.factor(df$Size)
df$Size <- model.matrix( ~ Size - 1, data=df)
df.Pricelm <- lm(Price ~ ., data=df)
df.Ratinglm <- lm(Rating ~ ., data = df)
dfPriceRes <- rstudent(df.Pricelm)
dfRatingRes <- rstudent(df.Ratinglm)
dfPrice.post <- df[abs(dfPriceRes) < 3,]
dfRating.post <- df[abs(dfRatingRes) < 3,]
dfPrice.post <- na.omit(dfPrice.post)
dfRating.post <- na.omit(dfRating.post)
which(apply(dfPrice.post, 2, var) == 0)
dfPrice.post <- select(dfPrice.post, -28)
colnames(dfPrice.post)
df <- read.csv("WineData.csv")
df <- na.omit(df)
df <- subset(df, select = -c(X, Id, Name, Winery, StyleName, Region,Country))
df <- subset(df, Acidity != -1 & Year > 1950)
df$Type <- as.factor(df$Type)
df$Type <- model.matrix( ~ Type - 1, data=df)
df$Vintage <- as.factor(df$Vintage)
df$Vintage <- model.matrix( ~ Vintage - 1, data=df)
df$Nat <- as.factor(df$Nat)
df$Nat <- model.matrix( ~ Nat - 1, data=df)
df$Country <- as.factor(df$Country)
df$Country <- model.matrix( ~ Country - 1, data=df)
df$Size <- as.factor(df$Size)
df$Size <- model.matrix( ~ Size - 1, data=df)
df.Pricelm <- lm(Price ~ ., data=df)
df.Ratinglm <- lm(Rating ~ ., data = df)
dfPriceRes <- rstudent(df.Pricelm)
dfRatingRes <- rstudent(df.Ratinglm)
dfPrice.post <- df[abs(dfPriceRes) < 3,]
dfRating.post <- df[abs(dfRatingRes) < 3,]
dfPrice.post <- na.omit(dfPrice.post)
dfRating.post <- na.omit(dfRating.post)
Price_pr.out <- prcomp(dfPrice.post[-c(Price)], scale=TRUE)
Price_pr.out <- prcomp(dfPrice.post[-c('Price')], scale=TRUE)
Price_pr.out <- prcomp(dfPrice.post[-c(1)], scale=TRUE)
Price_pr.out
Price_pr.out$rotation
biplot(Price_pr.out, scale = 0)
biplot(Price_pr.out, scale = 0)
Price_pr.out <- prcomp(dfPrice.post[-c(1)], scale=TRUE)
test <- predict(Price_pr.out, dfPrice.post)
test <- predict(Price_pr.out, dfPrice.post[-c(1)])
df <- read.csv("WineData.csv")
df <- na.omit(df)
df <- subset(df, select = -c(X, Id, Name, Winery, StyleName, Region,Country))
df <- subset(df, Acidity != -1 & Year > 1950)
df$Type <- as.factor(df$Type)
df$Type <- model.matrix( ~ Type - 1, data=df)
df$Vintage <- as.factor(df$Vintage)
df$Vintage <- model.matrix( ~ Vintage - 1, data=df)
df$Nat <- as.factor(df$Nat)
df$Nat <- model.matrix( ~ Nat - 1, data=df)
df$Country <- as.factor(df$Country)
df$Country <- model.matrix( ~ Country - 1, data=df)
df$Size <- as.factor(df$Size)
df$Size <- model.matrix( ~ Size - 1, data=df)
df.Pricelm <- lm(Price ~ ., data=df)
df.Ratinglm <- lm(Rating ~ ., data = df)
dfPriceRes <- rstudent(df.Pricelm)
dfRatingRes <- rstudent(df.Ratinglm)
dfPrice.post <- df[abs(dfPriceRes) < 3,]
dfRating.post <- df[abs(dfRatingRes) < 3,]
dfPrice.post <- na.omit(dfPrice.post)
dfRating.post <- na.omit(dfRating.post)
which(apply(dfPrice.post, 2, var) == 0)
dfPrice.post <- select(dfPrice.post, -28)
Price_pr.out <- prcomp(dfPrice.post[-c(1)], scale=TRUE)
test <- predict(Price_pr.out, dfPrice.post[-c(1)])
df <- subset(df, Acidity != -1 & Year > 1950 & Country != "Mexico")
df <- read.csv("WineData.csv")
df <- na.omit(df)
df <- subset(df, select = -c(X, Id, Name, Winery, StyleName, Region))
df <- subset(df, Acidity != -1 & Year > 1950 & Country != "Mexico")
df$Type <- as.factor(df$Type)
df$Type <- model.matrix( ~ Type - 1, data=df)
df$Vintage <- as.factor(df$Vintage)
df$Vintage <- model.matrix( ~ Vintage - 1, data=df)
df$Nat <- as.factor(df$Nat)
df$Nat <- model.matrix( ~ Nat - 1, data=df)
df$Country <- as.factor(df$Country)
df$Country <- model.matrix( ~ Country - 1, data=df)
df$Size <- as.factor(df$Size)
df$Size <- model.matrix( ~ Size - 1, data=df)
df.Pricelm <- lm(Price ~ ., data=df)
df.Ratinglm <- lm(Rating ~ ., data = df)
dfPriceRes <- rstudent(df.Pricelm)
dfRatingRes <- rstudent(df.Ratinglm)
dfPrice.post <- df[abs(dfPriceRes) < 3,]
dfRating.post <- df[abs(dfRatingRes) < 3,]
dfPrice.post <- na.omit(dfPrice.post)
dfRating.post <- na.omit(dfRating.post)
which(apply(dfPrice.post, 2, var) == 0)
Price_pr.out <- prcomp(dfPrice.post[-c(1)], scale=TRUE)
test <- predict(Price_pr.out, dfPrice.post[-c(1)])
Price_pr.out
Price_pr.out$rotation
library(pls)
Price_pcr.fit <- pcr(Price ~ ., data = dfPrice.post, scale=TRUE, validation = "CV")
df <- read.csv("WineData.csv")
df <- na.omit(df)
df <- subset(df, select = -c(X, Id, Name, Winery, StyleName, Region))
df <- subset(df, Acidity != -1 & Year > 1950 & Country != "Mexico")
df$Type <- as.factor(df$Type)
df$Type <- model.matrix( ~ Type - 1, data=df)
df$Vintage <- as.factor(df$Vintage)
df$Vintage <- model.matrix( ~ Vintage - 1, data=df)
df$Nat <- as.factor(df$Nat)
df$Nat <- model.matrix( ~ Nat - 1, data=df)
df$Country <- as.factor(df$Country)
df$Country <- model.matrix( ~ Country - 1, data=df)
df$Size <- as.factor(df$Size)
df$Size <- model.matrix( ~ Size - 1, data=df)
df.Pricelm <- lm(Price ~ ., data=df)
df.Ratinglm <- lm(Rating ~ ., data = df)
dfPriceRes <- rstudent(df.Pricelm)
dfRatingRes <- rstudent(df.Ratinglm)
dfPrice.post <- df[abs(dfPriceRes) < 3,]
dfRating.post <- df[abs(dfRatingRes) < 3,]
dfPrice.post <- na.omit(dfPrice.post)
dfRating.post <- na.omit(dfRating.post)
which(apply(dfPrice.post, 2, var) == 0)
Price_pcr.fit <- pcr(Price ~ ., data = dfPrice.post, scale=TRUE, validation = "CV")
dfPrice.post
df <- read.csv("WineData.csv")
df <- na.omit(df)
df <- subset(df, select = -c(X, Id, Name, Winery, StyleName, Region))
df <- subset(df, Acidity != -1 & Year > 1950 & Country != "Mexico")
df$Type <- as.factor(df$Type)
df$Type <- model.matrix( ~ Type - 1, data=df)
df$Vintage <- as.factor(df$Vintage)
df$Vintage <- model.matrix( ~ Vintage - 1, data=df)
df$Nat <- as.factor(df$Nat)
df$Nat <- model.matrix( ~ Nat - 1, data=df)
df$Country <- as.factor(df$Country)
df$Country <- model.matrix( ~ Country - 1, data=df)
df$Size <- as.factor(df$Size)
df$Size <- model.matrix( ~ Size - 1, data=df)
df.Pricelm <- lm(Price ~ ., data=df)
df.Ratinglm <- lm(Rating ~ ., data = df)
dfPriceRes <- rstudent(df.Pricelm)
dfRatingRes <- rstudent(df.Ratinglm)
dfPrice.post <- df[abs(dfPriceRes) < 3,]
dfRating.post <- df[abs(dfRatingRes) < 3,]
dfPrice.post <- na.omit(dfPrice.post)
dfRating.post <- na.omit(dfRating.post)
which(apply(dfPrice.post, 2, var) == 0)
dfPrice.post <- dfPrice.post[, colSums(dfPrice.post != 0) > 0]
dfPrice.post %>% select_if(colSums(.) != 0)
dfPrice.post[,-(which(colSums(dfPrice.post)==0))]
dfPrice.post <- dfPrice.post[,-(which(colSums(dfPrice.post)==0))]
dfPrice.post
df <- read.csv("WineData.csv")
df <- na.omit(df)
df <- subset(df, select = -c(X, Id, Name, Winery, StyleName, Region))
df <- subset(df, Acidity != -1 & Year > 1950 & Country != "Mexico")
df$Type <- as.factor(df$Type)
df$Type <- model.matrix( ~ Type - 1, data=df)
df$Vintage <- as.factor(df$Vintage)
df$Vintage <- model.matrix( ~ Vintage - 1, data=df)
df$Nat <- as.factor(df$Nat)
df$Nat <- model.matrix( ~ Nat - 1, data=df)
df$Country <- as.factor(df$Country)
df$Country <- model.matrix( ~ Country - 1, data=df)
df$Size <- as.factor(df$Size)
df$Size <- model.matrix( ~ Size - 1, data=df)
df.Pricelm <- lm(Price ~ ., data=df)
df.Ratinglm <- lm(Rating ~ ., data = df)
dfPriceRes <- rstudent(df.Pricelm)
dfRatingRes <- rstudent(df.Ratinglm)
dfPrice.post <- df[abs(dfPriceRes) < 3,]
dfRating.post <- df[abs(dfRatingRes) < 3,]
dfPrice.post <- na.omit(dfPrice.post)
dfRating.post <- na.omit(dfRating.post)
which(apply(dfPrice.post, 2, var) == 0)
Price_pr.out <- prcomp(dfPrice.post[-c(1)], scale=TRUE)
Price_pcr.fit <- pcr(Price ~ ., data = dfPrice.post, scale=TRUE, validation = "CV")
df <- read.csv("WineData.csv")
df <- na.omit(df)
df <- subset(df, select = -c(X, Id, Name, Winery, StyleName, Region))
df <- subset(df, Acidity != -1 & Year > 1950 & Country != "Mexico")
df$Type <- as.factor(df$Type)
df$Vintage <- as.factor(df$Vintage)
df$Nat <- as.factor(df$Nat)
df$Country <- as.factor(df$Country)
df$Size <- as.factor(df$Size)
df.Pricelm <- lm(Price ~ ., data=df)
df.Ratinglm <- lm(Rating ~ ., data = df)
dfPriceRes <- rstudent(df.Pricelm)
dfRatingRes <- rstudent(df.Ratinglm)
dfPrice.post <- df[abs(dfPriceRes) < 3,]
dfRating.post <- df[abs(dfRatingRes) < 3,]
dfPrice.post <- na.omit(dfPrice.post)
dfRating.post <- na.omit(dfRating.post)
Price_pcr.fit <- pcr(Price ~ ., data = dfPrice.post, scale=TRUE, validation = "CV")
dfPrice.post[, colSums(dfPrice.post != 0) > 0]
dfPrice.post <- dfPrice.post[, colSums(dfPrice.post != 0) > 0]
Price_pcr.fit <- pcr(Price ~ ., data = dfPrice.post, scale=TRUE, validation = "CV")
nzv <- sapply(dfPrice.post, var) < 10^-13
df <- read.csv("WineData.csv")
df <- na.omit(df)
df <- subset(df, select = -c(X, Id, Name, Winery, StyleName, Region))
df <- subset(df, Acidity != -1 & Year > 1950 & Country != "Mexico")
df$Type <- as.factor(df$Type)
df$Vintage <- as.factor(df$Vintage)
df$Nat <- as.factor(df$Nat)
df$Country <- as.factor(df$Country)
df$Size <- as.factor(df$Size)
df.Pricelm <- lm(Price ~ ., data=df)
df.Ratinglm <- lm(Rating ~ ., data = df)
dfPriceRes <- rstudent(df.Pricelm)
dfRatingRes <- rstudent(df.Ratinglm)
dfPrice.post <- df[abs(dfPriceRes) < 3,]
dfRating.post <- df[abs(dfRatingRes) < 3,]
dfPrice.post <- na.omit(dfPrice.post)
dfRating.post <- na.omit(dfRating.post)
which(apply(dfPrice.post, 2, var) == 0)
nzv <- sapply(dfPrice.post, var) < 10^-13
df <- read.csv("WineData.csv")
df <- na.omit(df)
df <- subset(df, select = -c(X, Id, Name, Winery, StyleName, Region))
df <- subset(df, Acidity != -1 & Year > 1950 & Country != "Mexico")
df$Type <- as.factor(df$Type)
df$Type <- model.matrix( ~ Type - 1, data=df)
df$Vintage <- as.factor(df$Vintage)
df$Vintage <- model.matrix( ~ Vintage - 1, data=df)
df$Nat <- as.factor(df$Nat)
df$Nat <- model.matrix( ~ Nat - 1, data=df)
df$Country <- as.factor(df$Country)
df$Country <- model.matrix( ~ Country - 1, data=df)
df$Size <- as.factor(df$Size)
df$Size <- model.matrix( ~ Size - 1, data=df)
df.Pricelm <- lm(Price ~ ., data=df)
df.Ratinglm <- lm(Rating ~ ., data = df)
dfPriceRes <- rstudent(df.Pricelm)
dfRatingRes <- rstudent(df.Ratinglm)
dfPrice.post <- df[abs(dfPriceRes) < 3,]
dfRating.post <- df[abs(dfRatingRes) < 3,]
dfPrice.post <- na.omit(dfPrice.post)
dfRating.post <- na.omit(dfRating.post)
nzv <- sapply(dfPrice.post, var) < 10^-13
nzv <- sapply(dfPrice.post, var) < 10^-13
dfPrice.post <- dfPrice.post[, colSums(dfPrice.post != 0) > 0]
Price_pcr.fit <- pcr(Price ~ ., data = dfPrice.post, scale=TRUE, validation = "CV")
dfPrice.post
colnames(dfPrice.post)
df <- read.csv("WineData.csv")
df <- na.omit(df)
df <- subset(df, select = -c(X, Id, Name, Winery, StyleName, Region))
df <- subset(df, Acidity != -1 & Year > 1950 & Country != "Mexico")
df$Type <- as.factor(df$Type)
df$Vintage <- as.factor(df$Vintage)
df$Nat <- as.factor(df$Nat)
df$Country <- as.factor(df$Country)
df$Size <- as.factor(df$Size)
df.Pricelm <- lm(Price ~ ., data=df)
df.Ratinglm <- lm(Rating ~ ., data = df)
dfPriceRes <- rstudent(df.Pricelm)
dfRatingRes <- rstudent(df.Ratinglm)
dfPrice.post <- df[abs(dfPriceRes) < 3,]
dfRating.post <- df[abs(dfRatingRes) < 3,]
dfPrice.post <- na.omit(dfPrice.post)
dfRating.post <- na.omit(dfRating.post)
which(apply(dfPrice.post, 2, var) == 0)
Price_pr.out <- prcomp(dfPrice.post[-c(1)], scale=TRUE)
dfPrice.post <- dfPrice.post[, colSums(dfPrice.post != 0) > 0]
Price_pcr.fit <- pcr(Price ~ ., data = dfPrice.post, scale=TRUE, validation = "CV")
df <- read.csv("WineData.csv")
df <- na.omit(df)
df <- subset(df, select = -c(X, Id, Name, Winery, StyleName, Region))
df <- subset(df, Acidity != -1 & Year > 1950 & Country != "Mexico")
df$Type <- as.factor(df$Type)
df$Vintage <- as.factor(df$Vintage)
df$Nat <- as.factor(df$Nat)
df$Country <- as.factor(df$Country)
df$Size <- as.factor(df$Size)
df.Pricelm <- lm(Price ~ ., data=df)
df.Ratinglm <- lm(Rating ~ ., data = df)
dfPriceRes <- rstudent(df.Pricelm)
dfRatingRes <- rstudent(df.Ratinglm)
dfPrice.post <- df[abs(dfPriceRes) < 3,]
dfRating.post <- df[abs(dfRatingRes) < 3,]
dfPrice.post <- na.omit(dfPrice.post)
dfRating.post <- na.omit(dfRating.post)
which(apply(dfPrice.post, 2, var) == 0)
df <- read.csv("WineData.csv")
df <- na.omit(df)
df <- subset(df, select = -c(X, Id, Name, Winery, StyleName, Region))
df <- subset(df, Acidity != -1 & Year > 1950 & Country != "Mexico")
df$Type <- as.factor(df$Type)
df$Vintage <- as.factor(df$Vintage)
df$Nat <- as.factor(df$Nat)
df$Country <- as.factor(df$Country)
df$Size <- as.factor(df$Size)
df.Pricelm <- lm(Price ~ ., data=df)
df.Ratinglm <- lm(Rating ~ ., data = df)
dfPriceRes <- rstudent(df.Pricelm)
dfRatingRes <- rstudent(df.Ratinglm)
dfPrice.post <- df[abs(dfPriceRes) < 3,]
dfRating.post <- df[abs(dfRatingRes) < 3,]
dfPrice.post <- na.omit(dfPrice.post)
dfRating.post <- na.omit(dfRating.post)
Price_pr.out <- prcomp(dfPrice.post[-c(1)], scale=TRUE)
df$Country <- as.numeric(as.factor(df$Country)
df$Country <- as.numeric(as.factor(df$Country))
df$Size <- as.factor(df$Size)
df$Country <- as.numeric(as.factor(df$Country))
Price_pr.out <- prcomp(dfPrice.post[-c(1)], scale=TRUE)
test <- predict(Price_pr.out, dfPrice.post[-c(1)])
Price_pcr.fit <- pcr(Price ~ ., data = dfPrice.post, scale=TRUE, validation = "CV")
dfPrice.post
df$Country = as.numeric(as.factor(df$Country))
df
dfPrice.post <- df[abs(dfPriceRes) < 3,]
dfPrice.post
dfRating.post <- df[abs(dfRatingRes) < 3,]
dfPrice.post <- na.omit(dfPrice.post)
dfPrice.post
Price_pr.out <- prcomp(dfPrice.post[-c(1)], scale=TRUE)
dfPrice.post
is.numeric(dfPrice.post)
df <- read.csv("WineData.csv")
df <- na.omit(df)
df <- subset(df, select = -c(X, Id, Name, Winery, StyleName, Region))
df <- subset(df, Acidity != -1 & Year > 1950 & Country != "Mexico")
df$Type <- as.factor(df$Type)
df$Type <- model.matrix( ~ Type - 1, data=df)
df$Vintage <- as.factor(df$Vintage)
df$Vintage <- model.matrix( ~ Vintage - 1, data=df)
df$Nat <- as.factor(df$Nat)
df$Nat <- model.matrix( ~ Nat - 1, data=df)
df$Country = as.factor(df$Country)
df$Country <- model.matrix( ~ Country - 1, data=df)
df$Size <- as.factor(df$Size)
df$Size <- model.matrix( ~ Size - 1, data=df)
df.Pricelm <- lm(Price ~ ., data=df)
df.Ratinglm <- lm(Rating ~ ., data = df)
dfPriceRes <- rstudent(df.Pricelm)
dfRatingRes <- rstudent(df.Ratinglm)
dfPrice.post <- df[abs(dfPriceRes) < 3,]
dfPrice.post
dfRating.post <- df[abs(dfRatingRes) < 3,]
dfPrice.post <- na.omit(dfPrice.post)
dfPrice.post
dfRating.post <- na.omit(dfRating.post)
Price_pr.out <- prcomp(dfPrice.post[-c(1)], scale=TRUE)
Price_pcr.fit <- pcr(Price ~ ., data = dfPrice.post, scale=TRUE, validation = "CV")
sum(is.na(dfPrice.post))
sum(is.na(Price_pr.out))
df <- read.csv("WineData.csv")
df <- na.omit(df)
df <- subset(df, select = -c(X, Id, Name, Winery, StyleName, Region))
df <- subset(df, Acidity != -1 & Year > 1950 & Country != "Mexico")
df$Type <- as.factor(df$Type)
df$Type <- model.matrix( ~ Type - 1, data=df)
df$Vintage <- as.factor(df$Vintage)
df$Vintage <- model.matrix( ~ Vintage - 1, data=df)
df$Nat <- as.factor(df$Nat)
df$Nat <- model.matrix( ~ Nat - 1, data=df)
df$Country = as.factor(df$Country)
df$Country <- model.matrix( ~ Country - 1, data=df)
df$Size <- as.factor(df$Size)
df$Size <- model.matrix( ~ Size - 1, data=df)
df.Pricelm <- lm(Price ~ ., data=df)
df.Ratinglm <- lm(Rating ~ ., data = df)
dfPriceRes <- rstudent(df.Pricelm)
dfRatingRes <- rstudent(df.Ratinglm)
dfPrice.post <- df[abs(dfPriceRes) < 3,]
dfRating.post <- df[abs(dfRatingRes) < 3,]
dfPrice.post <- na.omit(dfPrice.post)
dfRating.post <- na.omit(dfRating.post)
Price_regfit.full <- regsubsets(Price ~ ., data = dfPrice.post, nvmax = 20)
library(glmnet)
library(boot)
library(leaps)
library(Matrix)
library(pls)
Price_regfit.full <- regsubsets(Price ~ ., data = dfPrice.post, nvmax = 20)
dfPrice.post <- as.data.frame(scale(dfPrice.post[2:11]))
Price_regfit.full <- regsubsets(Price ~ ., data = dfPrice.post, nvmax = 20)
dfPrice.post
df <- read.csv("WineData.csv")
df <- na.omit(df)
df <- subset(df, select = -c(X, Id, Name, Winery, StyleName, Region))
df <- subset(df, Acidity != -1 & Year > 1950 & Country != "Mexico")
df$Type <- as.factor(df$Type)
df$Type <- model.matrix( ~ Type - 1, data=df)
df$Vintage <- as.factor(df$Vintage)
df$Vintage <- model.matrix( ~ Vintage - 1, data=df)
df$Nat <- as.factor(df$Nat)
df$Nat <- model.matrix( ~ Nat - 1, data=df)
df$Country = as.factor(df$Country)
df$Country <- model.matrix( ~ Country - 1, data=df)
df$Size <- as.factor(df$Size)
df$Size <- model.matrix( ~ Size - 1, data=df)
df.Pricelm <- lm(Price ~ ., data=df)
df.Ratinglm <- lm(Rating ~ ., data = df)
dfPriceRes <- rstudent(df.Pricelm)
dfRatingRes <- rstudent(df.Ratinglm)
dfPrice.post <- df[abs(dfPriceRes) < 3,]
dfRating.post <- df[abs(dfRatingRes) < 3,]
dfPrice.post <- na.omit(dfPrice.post)
dfRating.post <- na.omit(dfRating.post)
Price_pr.out <- prcomp(dfPrice.post[-c(1)], scale=TRUE)
Price_pcr.fit <- pcr(Price ~ ., data = dfPrice.post, scale=TRUE, validation = "CV")
Price <- dfPrice.post[1]
dfPrice.post <- as.data.frame(scale(dfPrice.post[2:11]))
dfPrice.post <- cbind(Price, dfPrice.post)
Price_regfit.full <- regsubsets(Price ~ ., data = dfPrice.post, nvmax = 20)
Price_regfit.full <- regsubsets(Price ~ ., data = dfPrice.post, nvmax = 15)
Price_regfit.full <- regsubsets(Price ~ ., data = dfPrice.post, nvmax = 10)
plot(summary(Price_regfit.full)$adjr2, type="b", xlab="p", ylab=expression(R^2))
Price_regfit.full <- regsubsets(Price ~ ., data = dfPrice.post, nvmax = 30)
plot(summary(Price_regfit.full)$adjr2, type="b", xlab="p", ylab=expression(R^2))
Rating_regfit.full <- regsubsets(Rating ~ ., data = dfRating.post, nvmax = 20)
plot(summary(Rating_regfit.full)$adjr2, type = "b", xlab = "p", ylab = expression(R^2))
lot(summary(Price_regfit.full)$bic, type="b", xlab="p", ylab="BIC")
plot(summary(Price_regfit.full)$bic, type="b", xlab="p", ylab="BIC")
plot(summary(Rating_regfit.full)$bic)
plot(summary(Rating_regfit.full)$bic, type="b", xlab="p", ylab="BIC")
Rating_regfit.full <- regsubsets(Rating ~ ., data = dfRating.post, nvmax = 30)
plot(summary(Rating_regfit.full)$bic, type="b", xlab="p", ylab="BIC")
plot(summary(Price_regfit.full)$cp, type="b", xlab="p", ylab=expression(C[p]))
plot(summary(Rating_regfit.full)$cp, type="b", xlab="p", ylab=expression(C[p]))
